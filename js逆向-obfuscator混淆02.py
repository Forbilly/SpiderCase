# -*- encode: utf-8 -*-

'''
小蓝本 企业信息查询
https://www.xiaolanben.com/
target_url_source = 'https://www.xiaolanben.com/search?key=%E8%9A%82%E8%9A%81%E9%87%91%E6%9C%8D&page=1'

1，search： sign 关键字
2，断点查看参数信息
3，进入ob混淆加密文件
4，copy至编译器
5，强撸，缺啥补啥
'''

import time
import execjs

jscode = '''
function get_sign(_paramas, _time) {
    window = {}
    var _0x37553d = function () {
        var _0x1dc90b = true;
        return function (_0x250e4e, _0x2377ac) {
            var _0x799dc = _0x1dc90b ? function () {
                if (_0x2377ac) {
                    var _0x367741 = _0x2377ac["apply"](_0x250e4e, arguments);
                    _0x2377ac = null;
                    return _0x367741;
                }
            } : function () {
            };
            _0x1dc90b = false;
            return _0x799dc;
        };
    }();
    function _0x5b3b03() {
        _0x1d7037 && (XMLHttpRequest = _0x1d7037), _0x1d7037 = undefined;
    }
    var _0x3f4df2 = {};
    var datas = !function (_0x142954, _0x52a3db) {
        "object" == typeof exports && "object" == typeof module ? module["exports"] = _0x52a3db() : "function" == typeof define && define["amd"] ? define([], _0x52a3db) : "object" == typeof exports ? exports["HttpSigner"] = _0x52a3db() : _0x142954["HttpSigner"] = _0x52a3db();
    }(this, function () {
        return function (_0x2cf447) {
            function _0x43fa3e(_0x1b902e) {
                if (_0x27eb03[_0x1b902e]) {
                    return _0x27eb03[_0x1b902e]["exports"];
                }
                var _0x2ccf80 = _0x27eb03[_0x1b902e] = {"exports": {}, "id": _0x1b902e, "loaded": false};
                return _0x2cf447[_0x1b902e]["call"](_0x2ccf80["exports"], _0x2ccf80, _0x2ccf80["exports"], _0x43fa3e), _0x2ccf80["loaded"] = true, _0x2ccf80["exports"];
            }

            var _0x27eb03 = {};
            return _0x43fa3e["m"] = _0x2cf447, _0x43fa3e["c"] = _0x27eb03, _0x43fa3e["p"] = "", _0x43fa3e(0);
        }([
            function (_0x40b9c7, _0x5a09fa, _0x55a036) {
            "use strict";

            function _0x5024dc(_0x37cb72) {
                return _0x37cb72 && _0x37cb72["__esModule"] ? _0x37cb72 : {"default": _0x37cb72};
            }
            var _0x4ab49b = _0x55a036(1), _0x2d634e = _0x5024dc(_0x4ab49b), _0x846adf = _0x55a036(3),
                _0x4f2b0c = _0x5024dc(_0x846adf);
            var _0x3d63de = ["https://click.51zhangdan.com/manager/v3/message", "https://api.u51.com/nodejs-performance-log-server", "https://web.u51.com/api.u51.com/nodejs-performance-log-server"];

        },
            function (_0x1b1bc6, _0xff4ff9, _0x358c90) {
                "use strict";
                var _0x5e0b4f = {"value": true};
                Object["defineProperty"](_0xff4ff9, "__esModule", _0x5e0b4f);
                var _0x311a38 = _0x358c90(2);
                _0xff4ff9["default"] = '', _0x1b1bc6["exports"] = _0xff4ff9["default"];
            },
            function (_0x3fcaf9, _0x56ac6d) {
                "use strict";
                function _0x3b113c(_0xa7cfee, _0x251938) {
                    return _0xa7cfee = _0xa7cfee || "", _0xc251e8([_0xa7cfee, _0x1a4ea0, _0x21de39, _0x251938]["join"]("#"));
                }

                var _0x339aa1 = {"value": true};
                Object["defineProperty"](_0x56ac6d, "__esModule", _0x339aa1), _0x56ac6d["doSign"] = _0x3b113c;
                var _0x1a4ea0 = _0x56ac6d["version"] = "h5_0528151847@0", _0x21de39 = _0x56ac6d["secret"] = "pd1ela9y",
                    _0xc251e8 = function (_0x3e8cbb) {
                        function _0x116aa5(_0x57e75c, _0x1704b2) {
                            var _0x339cf1 = (65535 & _0x57e75c) + (65535 & _0x1704b2);
                            return (_0x57e75c >> 16) + (_0x1704b2 >> 16) + (_0x339cf1 >> 16) << 16 | 65535 & _0x339cf1;
                        }

                        function _0x45a510(_0x901d13, _0x3aa734) {
                            return _0x901d13 << _0x3aa734 | _0x901d13 >>> 32 - _0x3aa734;
                        }

                        function _0x185854(_0x343ca3, _0x409f0d, _0x17494a, _0x2be341, _0x40e163, _0x56861f) {
                            return _0x116aa5(_0x45a510(_0x116aa5(_0x116aa5(_0x409f0d, _0x343ca3), _0x116aa5(_0x2be341, _0x56861f)), _0x40e163), _0x17494a);
                        }

                        function _0x675ae5(_0x1d62f9, _0x2f6c03, _0x46aaff, _0x474c4b, _0xbbfbbe, _0x5e0693, _0x274040) {
                            return _0x185854(_0x2f6c03 & _0x46aaff | ~_0x2f6c03 & _0x474c4b, _0x1d62f9, _0x2f6c03, _0xbbfbbe, _0x5e0693, _0x274040);
                        }

                        function _0x250b18(_0x441fc5, _0x474ab6, _0x1b542e, _0x5d88ea, _0x186b17, _0x5b5caa, _0x9a3de7) {
                            return _0x185854(_0x474ab6 & _0x5d88ea | _0x1b542e & ~_0x5d88ea, _0x441fc5, _0x474ab6, _0x186b17, _0x5b5caa, _0x9a3de7);
                        }

                        function _0x221360(_0x4587da, _0x37acb3, _0x1a13d4, _0x110a3d, _0x21b604, _0x10600c, _0x128fe6) {
                            return _0x185854(_0x37acb3 ^ _0x1a13d4 ^ _0x110a3d, _0x4587da, _0x37acb3, _0x21b604, _0x10600c, _0x128fe6);
                        }

                        function _0x417698(_0x57bc99, _0x5b2d4a, _0x3e3a2d, _0x30f83f, _0xdbdd15, _0x366744, _0xd21fd3) {
                            return _0x185854(_0x3e3a2d ^ (_0x5b2d4a | ~_0x30f83f), _0x57bc99, _0x5b2d4a, _0xdbdd15, _0x366744, _0xd21fd3);
                        }

                        function _0x248d2c(_0x329c46, _0x2025c0) {
                            _0x329c46[_0x2025c0 >> 5] |= 128 << _0x2025c0 % 32, _0x329c46[14 + (_0x2025c0 + 64 >>> 9 << 4)] = _0x2025c0;
                            var _0x57d38d, _0x453e39, _0x339ac2, _0x497315, _0x1f88a5, _0x3cc34b = 1732584189,
                                _0x4337f8 = -271733888, _0x337703 = -1732584198, _0x3eb457 = 271733879;
                            for (_0x57d38d = 0; _0x57d38d < _0x329c46["length"]; _0x57d38d += 16) _0x453e39 = _0x3cc34b, _0x339ac2 = _0x4337f8, _0x497315 = _0x337703, _0x1f88a5 = _0x3eb457, _0x3cc34b = _0x675ae5(_0x3cc34b, _0x4337f8, _0x337703, _0x3eb457, _0x329c46[_0x57d38d], 7, -680876931), _0x3eb457 = _0x675ae5(_0x3eb457, _0x3cc34b, _0x4337f8, _0x337703, _0x329c46[_0x57d38d + 1], 12, -389564586), _0x337703 = _0x675ae5(_0x337703, _0x3eb457, _0x3cc34b, _0x4337f8, _0x329c46[_0x57d38d + 2], 17, 606105825), _0x4337f8 = _0x675ae5(_0x4337f8, _0x337703, _0x3eb457, _0x3cc34b, _0x329c46[_0x57d38d + 3], 22, -1044525330), _0x3cc34b = _0x675ae5(_0x3cc34b, _0x4337f8, _0x337703, _0x3eb457, _0x329c46[_0x57d38d + 4], 7, -176418897), _0x3eb457 = _0x675ae5(_0x3eb457, _0x3cc34b, _0x4337f8, _0x337703, _0x329c46[_0x57d38d + 5], 12, 1200080426), _0x337703 = _0x675ae5(_0x337703, _0x3eb457, _0x3cc34b, _0x4337f8, _0x329c46[_0x57d38d + 6], 17, -1473231341), _0x4337f8 = _0x675ae5(_0x4337f8, _0x337703, _0x3eb457, _0x3cc34b, _0x329c46[_0x57d38d + 7], 22, -45705983), _0x3cc34b = _0x675ae5(_0x3cc34b, _0x4337f8, _0x337703, _0x3eb457, _0x329c46[_0x57d38d + 8], 7, 1770035416), _0x3eb457 = _0x675ae5(_0x3eb457, _0x3cc34b, _0x4337f8, _0x337703, _0x329c46[_0x57d38d + 9], 12, -1958414417), _0x337703 = _0x675ae5(_0x337703, _0x3eb457, _0x3cc34b, _0x4337f8, _0x329c46[_0x57d38d + 10], 17, -42063), _0x4337f8 = _0x675ae5(_0x4337f8, _0x337703, _0x3eb457, _0x3cc34b, _0x329c46[_0x57d38d + 11], 22, -1990404162), _0x3cc34b = _0x675ae5(_0x3cc34b, _0x4337f8, _0x337703, _0x3eb457, _0x329c46[_0x57d38d + 12], 7, 1804603682), _0x3eb457 = _0x675ae5(_0x3eb457, _0x3cc34b, _0x4337f8, _0x337703, _0x329c46[_0x57d38d + 13], 12, -40341101), _0x337703 = _0x675ae5(_0x337703, _0x3eb457, _0x3cc34b, _0x4337f8, _0x329c46[_0x57d38d + 14], 17, -1502002290), _0x4337f8 = _0x675ae5(_0x4337f8, _0x337703, _0x3eb457, _0x3cc34b, _0x329c46[_0x57d38d + 15], 22, 1236535329), _0x3cc34b = _0x250b18(_0x3cc34b, _0x4337f8, _0x337703, _0x3eb457, _0x329c46[_0x57d38d + 1], 5, -165796510), _0x3eb457 = _0x250b18(_0x3eb457, _0x3cc34b, _0x4337f8, _0x337703, _0x329c46[_0x57d38d + 6], 9, -1069501632), _0x337703 = _0x250b18(_0x337703, _0x3eb457, _0x3cc34b, _0x4337f8, _0x329c46[_0x57d38d + 11], 14, 643717713), _0x4337f8 = _0x250b18(_0x4337f8, _0x337703, _0x3eb457, _0x3cc34b, _0x329c46[_0x57d38d], 20, -373897302), _0x3cc34b = _0x250b18(_0x3cc34b, _0x4337f8, _0x337703, _0x3eb457, _0x329c46[_0x57d38d + 5], 5, -701558691), _0x3eb457 = _0x250b18(_0x3eb457, _0x3cc34b, _0x4337f8, _0x337703, _0x329c46[_0x57d38d + 10], 9, 38016083), _0x337703 = _0x250b18(_0x337703, _0x3eb457, _0x3cc34b, _0x4337f8, _0x329c46[_0x57d38d + 15], 14, -660478335), _0x4337f8 = _0x250b18(_0x4337f8, _0x337703, _0x3eb457, _0x3cc34b, _0x329c46[_0x57d38d + 4], 20, -405537848), _0x3cc34b = _0x250b18(_0x3cc34b, _0x4337f8, _0x337703, _0x3eb457, _0x329c46[_0x57d38d + 9], 5, 568446438), _0x3eb457 = _0x250b18(_0x3eb457, _0x3cc34b, _0x4337f8, _0x337703, _0x329c46[_0x57d38d + 14], 9, -1019803690), _0x337703 = _0x250b18(_0x337703, _0x3eb457, _0x3cc34b, _0x4337f8, _0x329c46[_0x57d38d + 3], 14, -187363961), _0x4337f8 = _0x250b18(_0x4337f8, _0x337703, _0x3eb457, _0x3cc34b, _0x329c46[_0x57d38d + 8], 20, 1163531501), _0x3cc34b = _0x250b18(_0x3cc34b, _0x4337f8, _0x337703, _0x3eb457, _0x329c46[_0x57d38d + 13], 5, -1444681461), _0x3eb457 = _0x250b18(_0x3eb457, _0x3cc34b, _0x4337f8, _0x337703, _0x329c46[_0x57d38d + 2], 9, -51403784), _0x337703 = _0x250b18(_0x337703, _0x3eb457, _0x3cc34b, _0x4337f8, _0x329c46[_0x57d38d + 7], 14, 1735328476), _0x4337f8 = _0x250b18(_0x4337f8, _0x337703, _0x3eb457, _0x3cc34b, _0x329c46[_0x57d38d + 12], 20, -1926607736), _0x3cc34b = _0x221360(_0x3cc34b, _0x4337f8, _0x337703, _0x3eb457, _0x329c46[_0x57d38d + 5], 4, -378552), _0x3eb457 = _0x221360(_0x3eb457, _0x3cc34b, _0x4337f8, _0x337703, _0x329c46[_0x57d38d + 8], 11, -2022574466), _0x337703 = _0x221360(_0x337703, _0x3eb457, _0x3cc34b, _0x4337f8, _0x329c46[_0x57d38d + 11], 16, 1839030563), _0x4337f8 = _0x221360(_0x4337f8, _0x337703, _0x3eb457, _0x3cc34b, _0x329c46[_0x57d38d + 14], 23, -35309559), _0x3cc34b = _0x221360(_0x3cc34b, _0x4337f8, _0x337703, _0x3eb457, _0x329c46[_0x57d38d + 1], 4, -1530992060), _0x3eb457 = _0x221360(_0x3eb457, _0x3cc34b, _0x4337f8, _0x337703, _0x329c46[_0x57d38d + 4], 11, 1272893353), _0x337703 = _0x221360(_0x337703, _0x3eb457, _0x3cc34b, _0x4337f8, _0x329c46[_0x57d38d + 7], 16, -155497632), _0x4337f8 = _0x221360(_0x4337f8, _0x337703, _0x3eb457, _0x3cc34b, _0x329c46[_0x57d38d + 10], 23, -1094730640), _0x3cc34b = _0x221360(_0x3cc34b, _0x4337f8, _0x337703, _0x3eb457, _0x329c46[_0x57d38d + 13], 4, 681279174), _0x3eb457 = _0x221360(_0x3eb457, _0x3cc34b, _0x4337f8, _0x337703, _0x329c46[_0x57d38d], 11, -358537222), _0x337703 = _0x221360(_0x337703, _0x3eb457, _0x3cc34b, _0x4337f8, _0x329c46[_0x57d38d + 3], 16, -722521979), _0x4337f8 = _0x221360(_0x4337f8, _0x337703, _0x3eb457, _0x3cc34b, _0x329c46[_0x57d38d + 6], 23, 76029189), _0x3cc34b = _0x221360(_0x3cc34b, _0x4337f8, _0x337703, _0x3eb457, _0x329c46[_0x57d38d + 9], 4, -640364487), _0x3eb457 = _0x221360(_0x3eb457, _0x3cc34b, _0x4337f8, _0x337703, _0x329c46[_0x57d38d + 12], 11, -421815835), _0x337703 = _0x221360(_0x337703, _0x3eb457, _0x3cc34b, _0x4337f8, _0x329c46[_0x57d38d + 15], 16, 530742520), _0x4337f8 = _0x221360(_0x4337f8, _0x337703, _0x3eb457, _0x3cc34b, _0x329c46[_0x57d38d + 2], 23, -995338651), _0x3cc34b = _0x417698(_0x3cc34b, _0x4337f8, _0x337703, _0x3eb457, _0x329c46[_0x57d38d], 6, -198630844), _0x3eb457 = _0x417698(_0x3eb457, _0x3cc34b, _0x4337f8, _0x337703, _0x329c46[_0x57d38d + 7], 10, 1126891415), _0x337703 = _0x417698(_0x337703, _0x3eb457, _0x3cc34b, _0x4337f8, _0x329c46[_0x57d38d + 14], 15, -1416354905), _0x4337f8 = _0x417698(_0x4337f8, _0x337703, _0x3eb457, _0x3cc34b, _0x329c46[_0x57d38d + 5], 21, -57434055), _0x3cc34b = _0x417698(_0x3cc34b, _0x4337f8, _0x337703, _0x3eb457, _0x329c46[_0x57d38d + 12], 6, 1700485571), _0x3eb457 = _0x417698(_0x3eb457, _0x3cc34b, _0x4337f8, _0x337703, _0x329c46[_0x57d38d + 3], 10, -1894986606), _0x337703 = _0x417698(_0x337703, _0x3eb457, _0x3cc34b, _0x4337f8, _0x329c46[_0x57d38d + 10], 15, -1051523), _0x4337f8 = _0x417698(_0x4337f8, _0x337703, _0x3eb457, _0x3cc34b, _0x329c46[_0x57d38d + 1], 21, -2054922799), _0x3cc34b = _0x417698(_0x3cc34b, _0x4337f8, _0x337703, _0x3eb457, _0x329c46[_0x57d38d + 8], 6, 1873313359), _0x3eb457 = _0x417698(_0x3eb457, _0x3cc34b, _0x4337f8, _0x337703, _0x329c46[_0x57d38d + 15], 10, -30611744), _0x337703 = _0x417698(_0x337703, _0x3eb457, _0x3cc34b, _0x4337f8, _0x329c46[_0x57d38d + 6], 15, -1560198380), _0x4337f8 = _0x417698(_0x4337f8, _0x337703, _0x3eb457, _0x3cc34b, _0x329c46[_0x57d38d + 13], 21, 1309151649), _0x3cc34b = _0x417698(_0x3cc34b, _0x4337f8, _0x337703, _0x3eb457, _0x329c46[_0x57d38d + 4], 6, -145523072), _0x3eb457 = _0x417698(_0x3eb457, _0x3cc34b, _0x4337f8, _0x337703, _0x329c46[_0x57d38d + 11], 10, -1120210370), _0x337703 = _0x417698(_0x337703, _0x3eb457, _0x3cc34b, _0x4337f8, _0x329c46[_0x57d38d + 2], 15, 718787257), _0x4337f8 = _0x417698(_0x4337f8, _0x337703, _0x3eb457, _0x3cc34b, _0x329c46[_0x57d38d + 9], 21, -343485560), _0x3cc34b = _0x116aa5(_0x3cc34b, _0x453e39), _0x4337f8 = _0x116aa5(_0x4337f8, _0x339ac2), _0x337703 = _0x116aa5(_0x337703, _0x497315), _0x3eb457 = _0x116aa5(_0x3eb457, _0x1f88a5);
                            return [_0x3cc34b, _0x4337f8, _0x337703, _0x3eb457];
                        }

                        function _0x1e2233(_0x41b32e) {
                            var _0x464584, _0x48ab84 = "", _0x18463f = 32 * _0x41b32e["length"];
                            for (_0x464584 = 0; _0x464584 < _0x18463f; _0x464584 += 8) _0x48ab84 += String["fromCharCode"](_0x41b32e[_0x464584 >> 5] >>> _0x464584 % 32 & 255);
                            return _0x48ab84;
                        }

                        function _0x38b1f5(_0x1ff83a) {
                            var _0x2ddd9a, _0x484b2b = [];
                            for (_0x484b2b[(_0x1ff83a["length"] >> 2) - 1] = undefined, _0x2ddd9a = 0; _0x2ddd9a < _0x484b2b["length"]; _0x2ddd9a += 1) _0x484b2b[_0x2ddd9a] = 0;
                            var _0x4ac6c4 = 8 * _0x1ff83a["length"];
                            for (_0x2ddd9a = 0; _0x2ddd9a < _0x4ac6c4; _0x2ddd9a += 8) _0x484b2b[_0x2ddd9a >> 5] |= (255 & _0x1ff83a["charCodeAt"](_0x2ddd9a / 8)) << _0x2ddd9a % 32;
                            return _0x484b2b;
                        }

                        function _0x5bcad6(_0x541a4e) {
                            return _0x1e2233(_0x248d2c(_0x38b1f5(_0x541a4e), 8 * _0x541a4e["length"]));
                        }

                        function _0x2bd9e5(_0x281dc7, _0x320183) {
                            var _0xf9665a, _0x1c99d5, _0x36692d = _0x38b1f5(_0x281dc7), _0x273aad = [], _0x23452f = [];
                            for (_0x273aad[15] = _0x23452f[15] = undefined, _0x36692d["length"] > 16 && (_0x36692d = _0x248d2c(_0x36692d, 8 * _0x281dc7["length"])), _0xf9665a = 0; _0xf9665a < 16; _0xf9665a += 1) _0x273aad[_0xf9665a] = 909522486 ^ _0x36692d[_0xf9665a], _0x23452f[_0xf9665a] = 1549556828 ^ _0x36692d[_0xf9665a];
                            return _0x1c99d5 = _0x248d2c(_0x273aad["concat"](_0x38b1f5(_0x320183)), 512 + 8 * _0x320183["length"]), _0x1e2233(_0x248d2c(_0x23452f["concat"](_0x1c99d5), 640));
                        }

                        function _0x1855f7(_0x31f4a8) {
                            var _0x17c26e, _0x4b3c7f, _0x4ef469 = "0123456789abcdef", _0x30fa8a = "";
                            for (_0x4b3c7f = 0; _0x4b3c7f < _0x31f4a8["length"]; _0x4b3c7f += 1) _0x17c26e = _0x31f4a8["charCodeAt"](_0x4b3c7f), _0x30fa8a += _0x4ef469["charAt"](_0x17c26e >>> 4 & 15) + _0x4ef469["charAt"](15 & _0x17c26e);
                            return _0x30fa8a;
                        }

                        function _0x2e0b38(_0xf7990d) {
                            return unescape(encodeURIComponent(_0xf7990d));
                        }

                        function _0x5d5b1f(_0x4279e0) {
                            return _0x5bcad6(_0x2e0b38(_0x4279e0));
                        }

                        function _0x20a682(_0x4d5be0) {
                            return _0x1855f7(_0x5d5b1f(_0x4d5be0));
                        }

                        function _0x11f574(_0x4f1a11, _0x55e2eb) {
                            return _0x2bd9e5(_0x2e0b38(_0x4f1a11), _0x2e0b38(_0x55e2eb));
                        }

                        function _0x1ae9bc(_0x29a964, _0x10d04e) {
                            return _0x1855f7(_0x11f574(_0x29a964, _0x10d04e));
                        }

                        return function (_0x1c33c9, _0x5d247e, _0x3aaac2) {
                            return _0x5d247e ? _0x3aaac2 ? _0x11f574(_0x5d247e, _0x1c33c9) : _0x1ae9bc(_0x5d247e, _0x1c33c9) : _0x3aaac2 ? _0x5d5b1f(_0x1c33c9) : _0x20a682(_0x1c33c9);
                        }(_0x3e8cbb);
                    };
                var a = _0x3b113c(_paramas, _time);
                window['_sign'] = a;
                return a
            },
            function (_0x35ad26, _0x274d76, _0x48fe43) {

            }
        ]);
    });
    return window
}
'''
ctx = execjs.compile(jscode)
data = ctx.call('get_sign', 'keyword=%E6%B1%9F%E8%8B%8F&pageId=4&pageSize=14', time.time())
print(data)